<!DOCTYPE html>
<html lang="en">
    <head>
  <meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>

<meta name="googlebot" content="index,follow,snippet,archive"/>
<meta name="robots" content="all,follow">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="author" content=""/>

<meta name="generator" content="Hugo 0.80.0" />
    <title> Racket notes |  Tori Writes (Online)</title>
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  
  
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’¾</text></svg>">

  <link href="https://cdn.jsdelivr.net/npm/victormono@latest/dist/index.min.css" rel="stylesheet" onload="this.media='all';this.onload=null;">
<link href="https://fonts.googleapis.com/css2?family=Fira+Sans+Condensed:wght@400;700;900&display=swap" rel="stylesheet" onload="this.media='all';this.onload=null;">
<script src="https://kit.fontawesome.com/1902dd0653.js" crossorigin="anonymous"></script>
<noscript>
  <link href="https://cdn.jsdelivr.net/npm/victormono@latest/dist/index.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Sans+Condensed:wght@400;700;900&display=swap" rel="stylesheet">
</noscript>

  
  <link rel="stylesheet" href="/css/vendors/98.css">



<link href="/css/main.css" rel="stylesheet" defer/>


<style>
  @charset "UTF-8";@keyframes flicker{0%{opacity:1}10%{opacity:.4}20%{opacity:1}}@keyframes flicker-all{0%{opacity:1}3%{opacity:.8}6%{opacity:1}7%{opacity:1}8%{opacity:.6}9%{opacity:1}10%{opacity:1}99%{opacity:.8;text-shadow:none}100%{opacity:1}}*,*::before,*::after{margin:0;padding:0}html,body{font-family:victor mono,monospace;font-size:16px;font-weight:400}*,*::before,*::after{box-sizing:border-box}html,body{height:100%;width:100%}body{background-color:teal}main.page{background-image:linear-gradient(to bottom,rgba(226,227,233,0.4),rgba(226,227,233,0.4)),url("/images/clouds.png");background-repeat:no-repeat;background-size:cover;height:100%;overflow:auto;padding:1rem;width:100%}body a{text-decoration:none}nav{position:absolute}nav ul{list-style:none}
</style>




</head>
    <body>
      
  <main class="page">
    <div class="title">
      <h1>Racket notes</h1>
      <div class="line"></div>
    </div>
    
      <h2 id="basic">Basic</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket"><span style="color:#f92672">#lang </span>racket
(<span style="color:#66d9ef">provide</span> (<span style="color:#66d9ef">all-defined-out</span>))

<span style="color:#75715e">;this is a comment</span>

(<span style="color:#66d9ef">define</span> s <span style="color:#e6db74">&#34;hello&#34;</span>)

(<span style="color:#66d9ef">define</span> x <span style="color:#ae81ff">3</span>)
(<span style="color:#66d9ef">define</span> y (+ x <span style="color:#ae81ff">2</span>))

(<span style="color:#66d9ef">define</span> cube1
  (<span style="color:#66d9ef">lambda</span> (x)
    (* x (* x x))))

(<span style="color:#66d9ef">define</span> cube2
  (<span style="color:#66d9ef">lambda</span> (x)
    (* x x x)))

(<span style="color:#66d9ef">define</span> (cube3 x)
  (* x x x))

(<span style="color:#66d9ef">define</span> (pow1 x y)
  (<span style="color:#66d9ef">if</span> (=y <span style="color:#ae81ff">0</span>)
      <span style="color:#ae81ff">1</span>
      (* x (pow1 x (- y <span style="color:#ae81ff">1</span>)))))

<span style="color:#75715e">; currying</span>
(<span style="color:#66d9ef">define</span> pow2
  (<span style="color:#66d9ef">lambda</span> (x)
    (<span style="color:#66d9ef">lambda</span> (y)
      (pow1 x y))))

</code></pre></div><h3 id="list">List</h3>
<ul>
<li>Empty list: <code>null</code>
<ul>
<li><code>()</code> doesn&quot;t work for <code>null</code> but <code>'()</code> does</li>
</ul>
</li>
<li>build a list: <code>(list e1 ... en)</code></li>
<li>Constructor: <code>cons</code></li>
<li>Access head of list: <code>car</code></li>
<li>Access tail of list: <code>cdr</code></li>
<li>Check for empty: <code>null?</code></li>
</ul>
<h3 id="syntax">Syntax</h3>
<p>A term is either:</p>
<ul>
<li>An atom like <code>#t, #f, 34, &quot;hi&quot;, null, 4.0, x,...</code></li>
<li>A special form like <code>define, lambda, if</code></li>
<li>A sequence of terms in parentheses: <code>(t1 t2 t3)</code></li>
<li>Can use <code>[</code> anything you use <code>(</code></li>
</ul>
<p>Remember parentheses matters! For example:
<code>(e)</code> means call e with 0 argument.</p>
<h3 id="dynamic-typing">Dynamic typing</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> lst (list <span style="color:#66d9ef">#t</span> <span style="color:#e6db74">&#34;hi&#34;</span> <span style="color:#ae81ff">1</span> (list <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span>)))<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><h3 id="cond">Cond</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> (sum3 xs)
  (<span style="color:#66d9ef">cond</span> [(null? xs) <span style="color:#ae81ff">0</span>]
        [(number? (car xs)) (+ (car xs) (sum3 (cdr xs)))]
        [<span style="color:#66d9ef">#t</span> <span style="color:#ae81ff">0</span>]))<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><h3 id="what-is-true">What is true?</h3>
<p>Anything that is not <code>#f</code> is true <code>#t</code>.</p>
<h3 id="local-bindings">Local bindings</h3>
<h4 id="letletletrec">let/let*/letrec</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">let</span> ([x1 e1]
      [x2 e2]
      <span style="color:#66d9ef">...</span>
      [xn en])
  e)<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>Racket uses the environment <strong>before</strong> the let-expression to evaluate <code>e1 e2 ... en</code>, which means if <code>en</code> uses <code>x1</code>, <code>x2</code>, that would mean some outer variables of the same name. Instead, the expressions in <code>let*</code> are evaluated in the environment produced from the previous bindings (later ones shadow) .</p>
<p>The expressions in <code>letrec</code> are evaluated in the environment that includes all th bindings. It is needed for mutual recursion.</p>
<h3 id="set">set!</h3>
<p>Racket has assignment statements:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">set!</span> x e)<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>Once you have side-effects, sequences are useful:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">begin</span> e1 e2 e3)<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><h3 id="consmcons">cons/mcons</h3>
<p><code>cons</code> produces pairs or lists. (Actually lists are just extented pairs)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> pr (cons <span style="color:#ae81ff">1</span> (cons <span style="color:#66d9ef">#t</span> <span style="color:#e6db74">&#34;hi&#34;</span>))) <span style="color:#75715e">; is a pair</span>
(<span style="color:#66d9ef">define</span> lst (cons <span style="color:#ae81ff">1</span> (cons <span style="color:#66d9ef">#t</span> (cons <span style="color:#e6db74">&#34;hi&#34;</span> null)))) <span style="color:#75715e">; is a list</span>
</code></pre></div><p><code>mcons</code> is another way to make pairs which allows you to change the value inside piars:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> mpr (mcons <span style="color:#ae81ff">1</span> (mcons <span style="color:#66d9ef">#t</span> <span style="color:#e6db74">&#34;hi&#34;</span>)))
(mcar mpr) <span style="color:#75715e">; 1</span>
(mcdr mpr) <span style="color:#75715e">; (mcons (#t &#34;hi&#34;))</span>
(set-mcdr! mpr <span style="color:#ae81ff">47</span>) <span style="color:#75715e">; mpr becomes (mcons 1 47)</span>
</code></pre></div><p>Related form:</p>
<ul>
<li><code>mcons</code></li>
<li><code>mcar</code></li>
<li><code>mcdr</code></li>
<li><code>mpair?</code></li>
<li><code>set-mcar!</code></li>
<li><code>set-mcdr!</code></li>
</ul>
<h2 id="delayed-evaluation-and-thunk">Delayed Evaluation and Thunk</h2>
<p>In most programming languages, given <code>e1 e2 ... en</code>, the function arguments <code>e2, ..., en</code> are evaluated once before the function body is executed.
So if we define a function like:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rkt" data-lang="rkt">(<span style="color:#66d9ef">define</span> (my-if-bad x y z) (<span style="color:#66d9ef">if</span> x y z))

(<span style="color:#66d9ef">define</span> (factorial-wrong x)
  (my-if-bad (= x <span style="color:#ae81ff">0</span>)
             <span style="color:#ae81ff">1</span>
             (* x (factorial-wrong (- x <span style="color:#ae81ff">1</span>)))))<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>if we use <code>if</code> instead of <code>my-if-bad</code>, <code>factorial-wrong</code> acts just like we want. But with <code>my-if-bad</code>, the function never stops because the two branches evaluate at the same time.</p>
<p>Thanks to lambda, we can delay the evaluation, using the fact that function bodies are not evaluated until the function gets called.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rkt" data-lang="rkt">(<span style="color:#66d9ef">define</span> (my-if x y z) (<span style="color:#66d9ef">if</span> x (y) (z)))

(<span style="color:#66d9ef">define</span> (factorial x)
  (my-if (= x <span style="color:#ae81ff">0</span>)
         (<span style="color:#66d9ef">lambda</span> () <span style="color:#ae81ff">1</span>)
         (<span style="color:#66d9ef">lambda</span> () (* x (factorial (- x <span style="color:#ae81ff">1</span>))))))<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>The general idiom of using a zero-argument function to delay evaluation is also called a <strong>thunk</strong> (or, thunk the argument).</p>
<p>By the way,</p>
<h2 id="lazy-evaluationcall-by-needpromises">Lazy-evaluation/Call-by-need/Promises</h2>
<h2 id="streams">Streams</h2>
<p>A stream is an infinite sequence of values.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket"><span style="color:#f92672">#lang </span>racket
<span style="color:#75715e">; 1 1 1 1 ...</span>
(<span style="color:#66d9ef">define</span> ones (<span style="color:#66d9ef">lambda</span> () (cons <span style="color:#ae81ff">1</span> ones)))

<span style="color:#75715e">; 1 2 3 4 ...</span>
(<span style="color:#66d9ef">define</span> nats
  (<span style="color:#66d9ef">letrec</span> ([f (<span style="color:#66d9ef">lambda</span> (x) (cons x (<span style="color:#66d9ef">lambda</span> () (f (+ x <span style="color:#ae81ff">1</span>)))))])
     (<span style="color:#66d9ef">lambda</span> () (f <span style="color:#ae81ff">1</span>))))

<span style="color:#75715e">; 2 4 6 8 ...</span>
(<span style="color:#66d9ef">define</span> power-of-two
  (<span style="color:#66d9ef">letrec</span> ([f (<span style="color:#66d9ef">lambda</span> (x) (cons x (<span style="color:#66d9ef">lambda</span> () (f (* x <span style="color:#ae81ff">2</span>)))))])
    (<span style="color:#66d9ef">lambda</span> () (f <span style="color:#ae81ff">2</span>))))

<span style="color:#75715e">; higher-order maker</span>
(<span style="color:#66d9ef">define</span> (stream-maker fn arg)
  (<span style="color:#66d9ef">letrec</span> ([f (<span style="color:#66d9ef">lambda</span> (x) (cons x (<span style="color:#66d9ef">lambda</span> () (f (fn x arg)))))])
    (<span style="color:#66d9ef">lambda</span> () (f arg))))<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><h2 id="memoization-not-memorization">Memoization (Not Memorization)</h2>
<p>Memoization is another idiom related to lazy evaluation that does not actually use thunks. To implement memoization we do use mutation: Whenever the function is called with an argument we have not seen before, we compute the answer and then add the result to the table.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define</span> fibonacci
  (<span style="color:#66d9ef">letrec</span>([memo null]
          [f (<span style="color:#66d9ef">lambda</span> (x)
               (<span style="color:#66d9ef">let</span> ([ans (assoc x memo)])
                 (<span style="color:#66d9ef">if</span> ans
                     (cdr ans)
                     (<span style="color:#66d9ef">let</span> ([new-ans (<span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">or</span> (= x <span style="color:#ae81ff">1</span>) (= x <span style="color:#ae81ff">2</span>))
                                        <span style="color:#ae81ff">1</span>
                                        (+ (f (- x <span style="color:#ae81ff">1</span>))
                                           (f (- x <span style="color:#ae81ff">2</span>))))])
                       (<span style="color:#66d9ef">begin</span>
                         (<span style="color:#66d9ef">set!</span> memo (cons (cons x new-ans) memo))
                         new-ans)))))])
    f))<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><h2 id="macros">Macros</h2>
<p>Think about these things about macros and how Racket handles them better than other macro systems(notably C/C++)</p>
<ul>
<li>Tokenization</li>
<li>Parenthesization</li>
<li>Scope</li>
</ul>
<h3 id="syntax-1">Syntax</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">define-syntax</span> myif
  (<span style="color:#66d9ef">syntax-rules</span> (then <span style="color:#66d9ef">else</span>)
    [(my-if e1 then e2 <span style="color:#66d9ef">else</span> e3)
     (<span style="color:#66d9ef">if</span> e1 e2 e3)]))

(<span style="color:#66d9ef">define-syntax</span> my-delay
  (<span style="color:#66d9ef">syntax-rules</span> ()
    [(my-delay e)
     (mcons <span style="color:#66d9ef">#f</span> (<span style="color:#66d9ef">lambda</span> () e))]))

</code></pre></div><h3 id="hygiene">Hygiene</h3>
<h2 id="recursive-datatypes-via-racketss-struct">Recursive Datatypes Via Rackets&rsquo;s <code>struct</code></h2>
<p><a href="https://docs.racket-lang.org/reference/define-struct.html?q=struct#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29">https://docs.racket-lang.org/reference/define-struct.html?q=struct#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#66d9ef">struct</span> foo (bar baz quux) <span style="color:#66d9ef">#:transparent</span><span style="color:#960050;background-color:#1e0010">
</span></code></pre></div>
    
  </main>

      


    </body>
</html>
